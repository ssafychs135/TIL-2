## 리액트 버츄얼 돔 이해하기

### 1. 버츄얼 돔이란?

버츄얼 돔(Virtual DOM)은 실제 DOM의 추상화된 복사본으로, 메모리에 저장됩니다. 실제 DOM과 동일한 구조를 가지지만, 실제 화면에 렌더링되지 않는 JavaScript 객체입니다.

### 2. 버츄얼 돔의 동작 원리

리액트 애플리케이션에서 상태가 변경되면, 리액트는 새로운 버츄얼 돔 트리를 생성합니다. 이 새로운 버츄얼 돔 트리는 이전 버츄얼 돔 트리와 비교됩니다. 이 비교 과정을 'diffing'이라고 합니다.

#### Diffing 알고리즘

리액트는 효율적인 diffing 알고리즘을 사용하여 두 버츄얼 돔 트리 간의 차이점을 계산합니다. 이 알고리즘은 다음과 같은 휴리스틱을 기반으로 합니다:

*   **서로 다른 타입의 두 엘리먼트**: 리액트는 이전 트리의 DOM 노드를 완전히 파괴하고 새 트리의 DOM 노드를 처음부터 다시 만듭니다.
*   **동일한 타입의 두 엘리먼트**: 리액트는 두 엘리먼트의 속성(attributes)을 비교하고, 변경된 속성만 업데이트합니다. 자식 엘리먼트의 경우, 재귀적으로 비교합니다.
*   **리스트 엘리먼트**: 리액트는 각 아이템에 고유한 `key` prop을 사용하여 리스트 아이템의 변경 사항을 추적합니다. `key`를 통해 리액트는 어떤 아이템이 추가, 삭제, 또는 재정렬되었는지 효율적으로 파악할 수 있습니다.

#### Reconciliation (화해)

Diffing 알고리즘을 통해 계산된 차이점은 'reconciliation' 과정을 거쳐 실제 DOM에 적용됩니다. 리액트는 이 변경 사항들을 가능한 한 효율적으로 실제 DOM에 반영하여 화면을 업데이트합니다. 이 과정은 배치(batch)로 처리되어 DOM 조작 횟수를 최소화합니다.